import mongoose from 'mongoose';
import bcrypt from 'bcryptjs';
import { connectDatabase } from '../config/database';
import { User } from '../models/User';
import { Category } from '../models/Category';
import { Dish } from '../models/Dish';
import { MenuAnalytics } from '../models/MenuAnalytics';

// Donn√©es des cat√©gories multilingues
const categoriesData = [
  {
    name: {
      fr: 'Entr√©es',
      en: 'Appetizers',
      th: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ô‡πâ‡∏≥‡∏¢‡πà‡∏≠‡∏¢',
      ru: '–ó–∞–∫—É—Å–∫–∏',
      de: 'Vorspeisen'
    },
    description: {
      fr: 'D√©licieuses entr√©es pour commencer votre repas',
      en: 'Delicious appetizers to start your meal',
      th: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ô‡πâ‡∏≥‡∏¢‡πà‡∏≠‡∏¢‡∏≠‡∏£‡πà‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏°‡∏∑‡πâ‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£',
      ru: '–í–∫—É—Å–Ω—ã–µ –∑–∞–∫—É—Å–∫–∏ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ç—Ä–∞–ø–µ–∑—ã',
      de: 'K√∂stliche Vorspeisen f√ºr den Start Ihrer Mahlzeit'
    },
    icon: 'üç§',
    sortOrder: 1,
    isActive: true
  },
  {
    name: {
      fr: 'Soupes',
      en: 'Soups',
      th: '‡∏ã‡∏∏‡∏õ',
      ru: '–°—É–ø—ã',
      de: 'Suppen'
    },
    description: {
      fr: 'Soupes traditionnelles tha√Ølandaises',
      en: 'Traditional Thai soups',
      th: '‡∏ã‡∏∏‡∏õ‡πÑ‡∏ó‡∏¢‡πÅ‡∏ö‡∏ö‡∏î‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏¥‡∏°',
      ru: '–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Ç–∞–π—Å–∫–∏–µ —Å—É–ø—ã',
      de: 'Traditionelle thail√§ndische Suppen'
    },
    icon: 'üçú',
    sortOrder: 2,
    isActive: true
  },
  {
    name: {
      fr: 'Plats Principaux',
      en: 'Main Courses',
      th: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏à‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å',
      ru: '–û—Å–Ω–æ–≤–Ω—ã–µ –±–ª—é–¥–∞',
      de: 'Hauptgerichte'
    },
    description: {
      fr: 'Nos sp√©cialit√©s tha√Ølandaises authentiques',
      en: 'Our authentic Thai specialties',
      th: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏ó‡∏¢‡πÅ‡∏ó‡πâ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤',
      ru: '–ù–∞—à–∏ –∞—É—Ç–µ–Ω—Ç–∏—á–Ω—ã–µ —Ç–∞–π—Å–∫–∏–µ –±–ª—é–¥–∞',
      de: 'Unsere authentischen thail√§ndischen Spezialit√§ten'
    },
    icon: 'üçõ',
    sortOrder: 3,
    isActive: true
  },
  {
    name: {
      fr: 'Desserts',
      en: 'Desserts',
      th: '‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô',
      ru: '–î–µ—Å–µ—Ä—Ç—ã',
      de: 'Desserts'
    },
    description: {
      fr: 'Desserts traditionnels et modernes',
      en: 'Traditional and modern desserts',
      th: '‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏î‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏°‡∏±‡∏¢‡πÉ‡∏´‡∏°‡πà',
      ru: '–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–µ—Å–µ—Ä—Ç—ã',
      de: 'Traditionelle und moderne Desserts'
    },
    icon: 'üç∞',
    sortOrder: 4,
    isActive: true
  },
  {
    name: {
      fr: 'Boissons',
      en: 'Beverages',
      th: '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°',
      ru: '–ù–∞–ø–∏—Ç–∫–∏',
      de: 'Getr√§nke'
    },
    description: {
      fr: 'Boissons fra√Æches et cocktails tropicaux',
      en: 'Fresh drinks and tropical cocktails',
      th: '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏™‡∏î‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏Ñ‡πá‡∏≠‡∏Å‡πÄ‡∏ó‡∏•‡πÄ‡∏Ç‡∏ï‡∏£‡πâ‡∏≠‡∏ô',
      ru: '–°–≤–µ–∂–∏–µ –Ω–∞–ø–∏—Ç–∫–∏ –∏ —Ç—Ä–æ–ø–∏—á–µ—Å–∫–∏–µ –∫–æ–∫—Ç–µ–π–ª–∏',
      de: 'Frische Getr√§nke und tropische Cocktails'
    },
    icon: 'ü•§',
    sortOrder: 5,
    isActive: true
  }
];

// Donn√©es des plats
const dishesData = [
  // ENTR√âES
  {
    name: {
      fr: 'Rouleaux de Printemps',
      en: 'Spring Rolls',
      th: '‡∏õ‡∏≠‡πÄ‡∏õ‡∏µ‡πä‡∏¢‡∏∞‡∏™‡∏î',
      ru: '–°–ø—Ä–∏–Ω–≥-—Ä–æ–ª–ª—ã',
      de: 'Fr√ºhlingsrollen'
    },
    description: {
      fr: 'Rouleaux frais aux crevettes et l√©gumes croquants, sauce sweet chili',
      en: 'Fresh rolls with shrimp and crispy vegetables, sweet chili sauce',
      th: '‡∏õ‡∏≠‡πÄ‡∏õ‡∏µ‡πä‡∏¢‡∏∞‡∏™‡∏î‡∏Å‡∏∏‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏ú‡∏±‡∏Å‡∏Å‡∏£‡∏≠‡∏ö ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏°‡∏´‡∏ß‡∏≤‡∏ô',
      ru: '–°–≤–µ–∂–∏–µ —Ä–æ–ª–ª—ã —Å –∫—Ä–µ–≤–µ—Ç–∫–∞–º–∏ –∏ —Ö—Ä—É—Å—Ç—è—â–∏–º–∏ –æ–≤–æ—â–∞–º–∏, —Å–æ—É—Å —Å–ª–∞–¥–∫–∏–π —á–∏–ª–∏',
      de: 'Frische Rollen mit Garnelen und knackigem Gem√ºse, s√º√üe Chilisauce'
    },
    price: { amount: 120, currency: 'THB' },
    categoryName: 'Entr√©es',
    preparationTime: 10,
    dietary: { isVegetarian: false, isVegan: false, isSpicy: false },
    tags: { isNew: true, isPopular: false, isChefSpecial: false },
    allergens: ['crustaceans'],
    isActive: true
  },
  {
    name: {
      fr: 'Salade de Papaye Verte',
      en: 'Green Papaya Salad',
      th: '‡∏™‡πâ‡∏°‡∏ï‡∏≥',
      ru: '–°–∞–ª–∞—Ç –∏–∑ –∑–µ–ª–µ–Ω–æ–π –ø–∞–ø–∞–π–∏',
      de: 'Gr√ºner Papayasalat'
    },
    description: {
      fr: 'Salade √©pic√©e de papaye verte r√¢p√©e, tomates cerises, haricots verts',
      en: 'Spicy shredded green papaya salad with cherry tomatoes, green beans',
      th: '‡∏™‡πâ‡∏°‡∏ï‡∏≥‡πÑ‡∏ó‡∏¢‡∏£‡∏™‡∏à‡∏±‡∏î ‡∏°‡∏∞‡πÄ‡∏Ç‡∏∑‡∏≠‡πÄ‡∏ó‡∏®‡πÄ‡∏ä‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà ‡∏ñ‡∏±‡πà‡∏ß‡∏ù‡∏±‡∏Å‡∏¢‡∏≤‡∏ß',
      ru: '–û—Å—Ç—Ä—ã–π —Å–∞–ª–∞—Ç –∏–∑ —Ç–µ—Ä—Ç–æ–π –∑–µ–ª–µ–Ω–æ–π –ø–∞–ø–∞–π–∏ —Å –ø–æ–º–∏–¥–æ—Ä–∞–º–∏ —á–µ—Ä—Ä–∏, –∑–µ–ª–µ–Ω–æ–π —Ñ–∞—Å–æ–ª—å—é',
      de: 'Scharfer geraspelter gr√ºner Papayasalat mit Kirschtomaten, gr√ºnen Bohnen'
    },
    price: { amount: 80, currency: 'THB' },
    categoryName: 'Entr√©es',
    preparationTime: 8,
    dietary: { isVegetarian: true, isVegan: true, isSpicy: true, spicyLevel: 3 },
    tags: { isNew: false, isPopular: true, isChefSpecial: false },
    allergens: [],
    isActive: true
  },

  // SOUPES
  {
    name: {
      fr: 'Tom Yum Kung',
      en: 'Tom Yum Kung',
      th: '‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏Å‡∏∏‡πâ‡∏á',
      ru: '–¢–æ–º –Ø–º –ö—É–Ω–≥',
      de: 'Tom Yum Kung'
    },
    description: {
      fr: 'Soupe √©pic√©e aux crevettes, citronnelle, galanga, feuilles de lime',
      en: 'Spicy shrimp soup with lemongrass, galangal, lime leaves',
      th: '‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏Å‡∏∏‡πâ‡∏á‡∏£‡∏™‡∏à‡∏±‡∏î‡∏à‡πâ‡∏≤‡∏ô ‡∏ï‡∏∞‡πÑ‡∏Ñ‡∏£‡πâ ‡∏Ç‡πà‡∏≤ ‡πÉ‡∏ö‡∏°‡∏∞‡∏Å‡∏£‡∏π‡∏î',
      ru: '–û—Å—Ç—Ä—ã–π –∫—Ä–µ–≤–µ—Ç–æ—á–Ω—ã–π —Å—É–ø —Å –ª–µ–º–æ–Ω–≥—Ä–∞—Å—Å–æ–º, –≥–∞–ª–∞–Ω–≥–∞–ª–æ–º, –ª–∏—Å—Ç—å—è–º–∏ –ª–∞–π–º–∞',
      de: 'Scharfe Garnelensuppe mit Zitronengras, Galgant, Limettenbl√§ttern'
    },
    price: { amount: 220, currency: 'THB' },
    categoryName: 'Soupes',
    preparationTime: 15,
    dietary: { isVegetarian: false, isVegan: false, isSpicy: true, spicyLevel: 4 },
    tags: { isNew: false, isPopular: true, isChefSpecial: true },
    allergens: ['crustaceans'],
    isActive: true
  },
  {
    name: {
      fr: 'Tom Kha Gai',
      en: 'Tom Kha Gai',
      th: '‡∏ï‡πâ‡∏°‡∏Ç‡πà‡∏≤‡πÑ‡∏Å‡πà',
      ru: '–¢–æ–º –ö—Ö–∞ –ì–∞–π',
      de: 'Tom Kha Gai'
    },
    description: {
      fr: 'Soupe de poulet au lait de coco, galanga, champignons',
      en: 'Chicken soup with coconut milk, galangal, mushrooms',
      th: '‡∏ï‡πâ‡∏°‡∏Ç‡πà‡∏≤‡πÑ‡∏Å‡πà‡∏Å‡∏∞‡∏ó‡∏¥ ‡∏Ç‡πà‡∏≤ ‡πÄ‡∏´‡πá‡∏î',
      ru: '–ö—É—Ä–∏–Ω—ã–π —Å—É–ø —Å –∫–æ–∫–æ—Å–æ–≤—ã–º –º–æ–ª–æ–∫–æ–º, –≥–∞–ª–∞–Ω–≥–∞–ª–æ–º, –≥—Ä–∏–±–∞–º–∏',
      de: 'H√ºhnersuppe mit Kokosmilch, Galgant, Pilzen'
    },
    price: { amount: 180, currency: 'THB' },
    categoryName: 'Soupes',
    preparationTime: 12,
    dietary: { isVegetarian: false, isVegan: false, isSpicy: false },
    tags: { isNew: false, isPopular: true, isChefSpecial: false },
    allergens: [],
    isActive: true
  },

  // PLATS PRINCIPAUX
  {
    name: {
      fr: 'Pad Thai',
      en: 'Pad Thai',
      th: '‡∏ú‡∏±‡∏î‡πÑ‡∏ó‡∏¢',
      ru: '–ü–∞–¥ –¢–∞–π',
      de: 'Pad Thai'
    },
    description: {
      fr: 'Nouilles de riz saut√©es aux crevettes, tofu, germes de soja, cacahu√®tes',
      en: 'Stir-fried rice noodles with shrimp, tofu, bean sprouts, peanuts',
      th: '‡∏ú‡∏±‡∏î‡πÑ‡∏ó‡∏¢‡∏Å‡∏∏‡πâ‡∏á ‡πÄ‡∏ï‡πâ‡∏≤‡∏´‡∏π‡πâ ‡∏ñ‡∏±‡πà‡∏ß‡∏á‡∏≠‡∏Å ‡∏ñ‡∏±‡πà‡∏ß‡∏•‡∏¥‡∏™‡∏á',
      ru: '–ñ–∞—Ä–µ–Ω–∞—è —Ä–∏—Å–æ–≤–∞—è –ª–∞–ø—à–∞ —Å –∫—Ä–µ–≤–µ—Ç–∫–∞–º–∏, —Ç–æ—Ñ—É, —Ä–æ—Å—Ç–∫–∞–º–∏ —Ñ–∞—Å–æ–ª–∏, –∞—Ä–∞—Ö–∏—Å–æ–º',
      de: 'Gebratene Reisnudeln mit Garnelen, Tofu, Sojasprossen, Erdn√ºssen'
    },
    price: { amount: 160, currency: 'THB' },
    categoryName: 'Plats Principaux',
    preparationTime: 12,
    dietary: { isVegetarian: false, isVegan: false, isSpicy: false },
    tags: { isNew: false, isPopular: true, isChefSpecial: false },
    allergens: ['crustaceans', 'nuts', 'soy'],
    isActive: true
  },
  {
    name: {
      fr: 'Curry Vert au Poulet',
      en: 'Green Chicken Curry',
      th: '‡πÅ‡∏Å‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏´‡∏ß‡∏≤‡∏ô‡πÑ‡∏Å‡πà',
      ru: '–ó–µ–ª–µ–Ω–æ–µ –∫—É—Ä–∏–Ω–æ–µ –∫–∞—Ä—Ä–∏',
      de: 'Gr√ºnes H√ºhnchen-Curry'
    },
    description: {
      fr: 'Curry vert √©pic√© au poulet, aubergines tha√Ø, basilic, lait de coco',
      en: 'Spicy green curry with chicken, Thai eggplant, basil, coconut milk',
      th: '‡πÅ‡∏Å‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏´‡∏ß‡∏≤‡∏ô‡πÑ‡∏Å‡πà ‡∏°‡∏∞‡πÄ‡∏Ç‡∏∑‡∏≠ ‡πÇ‡∏´‡∏£‡∏∞‡∏û‡∏≤ ‡∏Å‡∏∞‡∏ó‡∏¥',
      ru: '–û—Å—Ç—Ä–æ–µ –∑–µ–ª–µ–Ω–æ–µ –∫–∞—Ä—Ä–∏ —Å –∫—É—Ä–∏—Ü–µ–π, —Ç–∞–π—Å–∫–∏–º–∏ –±–∞–∫–ª–∞–∂–∞–Ω–∞–º–∏, –±–∞–∑–∏–ª–∏–∫–æ–º, –∫–æ–∫–æ—Å–æ–≤—ã–º –º–æ–ª–æ–∫–æ–º',
      de: 'Scharfes gr√ºnes Curry mit Huhn, thail√§ndischen Auberginen, Basilikum, Kokosmilch'
    },
    price: { amount: 200, currency: 'THB' },
    categoryName: 'Plats Principaux',
    preparationTime: 18,
    dietary: { isVegetarian: false, isVegan: false, isSpicy: true, spicyLevel: 3 },
    tags: { isNew: false, isPopular: true, isChefSpecial: true },
    allergens: [],
    isActive: true
  },
  {
    name: {
      fr: 'Poisson Entier Grill√©',
      en: 'Grilled Whole Fish',
      th: '‡∏õ‡∏•‡∏≤‡πÄ‡∏ú‡∏≤',
      ru: '–ñ–∞—Ä–µ–Ω–∞—è —Ü–µ–ª–∞—è —Ä—ã–±–∞',
      de: 'Ganzer gegrillter Fisch'
    },
    description: {
      fr: 'Poisson frais grill√© aux herbes tha√Ø, sauce tamarind √©pic√©e',
      en: 'Fresh grilled fish with Thai herbs, spicy tamarind sauce',
      th: '‡∏õ‡∏•‡∏≤‡πÄ‡∏ú‡∏≤‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÑ‡∏ó‡∏¢ ‡∏ô‡πâ‡∏≥‡∏à‡∏¥‡πâ‡∏°‡∏°‡∏∞‡∏Ç‡∏≤‡∏°',
      ru: '–°–≤–µ–∂–∞—è –∂–∞—Ä–µ–Ω–∞—è —Ä—ã–±–∞ —Å —Ç–∞–π—Å–∫–∏–º–∏ —Ç—Ä–∞–≤–∞–º–∏, –æ—Å—Ç—Ä—ã–º —Å–æ—É—Å–æ–º —Ç–∞–º–∞—Ä–∏–Ω–¥',
      de: 'Frischer gegrillter Fisch mit thail√§ndischen Kr√§utern, scharfer Tamarindensauce'
    },
    price: { amount: 450, currency: 'THB' },
    categoryName: 'Plats Principaux',
    preparationTime: 25,
    dietary: { isVegetarian: false, isVegan: false, isSpicy: true, spicyLevel: 2 },
    tags: { isNew: true, isPopular: false, isChefSpecial: true },
    allergens: ['fish'],
    isActive: true
  },

  // DESSERTS
  {
    name: {
      fr: 'Riz Gluant √† la Mangue',
      en: 'Mango Sticky Rice',
      th: '‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á',
      ru: '–ö–ª–µ–π–∫–∏–π —Ä–∏—Å —Å –º–∞–Ω–≥–æ',
      de: 'Klebreis mit Mango'
    },
    description: {
      fr: 'Riz gluant sucr√© au lait de coco, mangue fra√Æche, graines de s√©same',
      en: 'Sweet sticky rice with coconut milk, fresh mango, sesame seeds',
      th: '‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏´‡∏ß‡∏≤‡∏ô‡∏Å‡∏∞‡∏ó‡∏¥ ‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á‡∏™‡∏∏‡∏Å ‡∏á‡∏≤‡∏Ç‡∏≤‡∏ß',
      ru: '–°–ª–∞–¥–∫–∏–π –∫–ª–µ–π–∫–∏–π —Ä–∏—Å —Å –∫–æ–∫–æ—Å–æ–≤—ã–º –º–æ–ª–æ–∫–æ–º, —Å–≤–µ–∂–∏–º –º–∞–Ω–≥–æ, —Å–µ–º–µ–Ω–∞–º–∏ –∫—É–Ω–∂—É—Ç–∞',
      de: 'S√º√üer Klebreis mit Kokosmilch, frischer Mango, Sesamsamen'
    },
    price: { amount: 120, currency: 'THB' },
    categoryName: 'Desserts',
    preparationTime: 5,
    dietary: { isVegetarian: true, isVegan: true, isSpicy: false },
    tags: { isNew: false, isPopular: true, isChefSpecial: false },
    allergens: ['sesame'],
    isActive: true
  },

  // BOISSONS
  {
    name: {
      fr: 'Th√© Tha√Ø Glac√©',
      en: 'Thai Iced Tea',
      th: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢‡πÄ‡∏¢‡πá‡∏ô',
      ru: '–•–æ–ª–æ–¥–Ω—ã–π —Ç–∞–π—Å–∫–∏–π —á–∞–π',
      de: 'Eisiger thail√§ndischer Tee'
    },
    description: {
      fr: 'Th√© noir √©pic√© au lait concentr√© sucr√©, servi sur glace',
      en: 'Spiced black tea with sweet condensed milk, served over ice',
      th: '‡∏ä‡∏≤‡∏î‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏® ‡∏ô‡∏°‡∏Ç‡πâ‡∏ô‡∏´‡∏ß‡∏≤‡∏ô ‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏¢‡πá‡∏ô',
      ru: '–ü—Ä—è–Ω—ã–π —á–µ—Ä–Ω—ã–π —á–∞–π —Å–æ —Å–ª–∞–¥–∫–∏–º —Å–≥—É—â–µ–Ω–Ω—ã–º –º–æ–ª–æ–∫–æ–º, –ø–æ–¥–∞–µ—Ç—Å—è —Å–æ –ª—å–¥–æ–º',
      de: 'Gew√ºrzter schwarzer Tee mit s√º√üer Kondensmilch, √ºber Eis serviert'
    },
    price: { amount: 60, currency: 'THB' },
    categoryName: 'Boissons',
    preparationTime: 3,
    dietary: { isVegetarian: true, isVegan: false, isSpicy: false },
    tags: { isNew: false, isPopular: true, isChefSpecial: false },
    allergens: ['milk'],
    isActive: true
  },
  {
    name: {
      fr: 'Cocktail Tropical',
      en: 'Tropical Cocktail',
      th: '‡∏Ñ‡πá‡∏≠‡∏Å‡πÄ‡∏ó‡∏•‡πÄ‡∏Ç‡∏ï‡∏£‡πâ‡∏≠‡∏ô',
      ru: '–¢—Ä–æ–ø–∏—á–µ—Å–∫–∏–π –∫–æ–∫—Ç–µ–π–ª—å',
      de: 'Tropischer Cocktail'
    },
    description: {
      fr: 'M√©lange de fruits tropicaux frais, rhum blanc, sirop de coco',
      en: 'Fresh tropical fruit mix, white rum, coconut syrup',
      th: '‡∏ú‡∏•‡πÑ‡∏°‡πâ‡πÄ‡∏Ç‡∏ï‡∏£‡πâ‡∏≠‡∏ô‡∏™‡∏î ‡∏£‡∏±‡∏° ‡πÑ‡∏ã‡∏£‡∏±‡∏õ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß',
      ru: '–°–º–µ—Å—å —Å–≤–µ–∂–∏—Ö —Ç—Ä–æ–ø–∏—á–µ—Å–∫–∏—Ö —Ñ—Ä—É–∫—Ç–æ–≤, –±–µ–ª—ã–π —Ä–æ–º, –∫–æ–∫–æ—Å–æ–≤—ã–π —Å–∏—Ä–æ–ø',
      de: 'Frische tropische Fr√ºchtemischung, wei√üer Rum, Kokossirup'
    },
    price: { amount: 180, currency: 'THB' },
    categoryName: 'Boissons',
    preparationTime: 5,
    dietary: { isVegetarian: true, isVegan: true, isSpicy: false },
    tags: { isNew: true, isPopular: false, isChefSpecial: false },
    allergens: ['alcohol'],
    isActive: true
  }
];

// Fonction de seeding
async function seedDatabase() {
  try {
    console.log('üå± D√©but du seeding de la base de donn√©es...');
    
    // Connexion √† la base de donn√©es
    await connectDatabase();
    console.log('‚úÖ Connexion √† MongoDB √©tablie');

    // Nettoyer les donn√©es existantes
    console.log('üßπ Nettoyage des donn√©es existantes...');
    await User.deleteMany({});
    await Category.deleteMany({});
    await Dish.deleteMany({});
    await MenuAnalytics.deleteMany({});
    console.log('‚úÖ Donn√©es nettoy√©es');

    // 1. Cr√©er un utilisateur admin
    console.log('üë§ Cr√©ation de l\'utilisateur admin...');
    const hashedPassword = await bcrypt.hash('admin123', 12);
    const adminUser = new User({
      name: 'Administrateur Restaurant',
      email: 'admin@restaurant-patong.com',
      password: hashedPassword,
      role: 'admin',
      language: 'fr',
      isActive: true
    });
    await adminUser.save();
    console.log('‚úÖ Utilisateur admin cr√©√©: admin@restaurant-patong.com / admin123');

    // 2. Cr√©er les cat√©gories
    console.log('üìÇ Cr√©ation des cat√©gories...');
    const savedCategories = [];
    for (const categoryData of categoriesData) {
      const category = new Category(categoryData);
      const savedCategory = await category.save();
      savedCategories.push(savedCategory);
      console.log(`  ‚úÖ ${categoryData.name.fr} cr√©√©e`);
    }

    // 3. Cr√©er les plats
    console.log('üçΩÔ∏è Cr√©ation des plats...');
    const savedDishes = [];
    for (const dishData of dishesData) {
      // Trouver la cat√©gorie correspondante
      const category = savedCategories.find(cat => 
        cat.name.fr === dishData.categoryName
      );
      
      if (category) {
        const dish = new Dish({
          ...dishData,
          category: category._id
        });
        delete dish.categoryName; // Supprimer le champ temporaire
        const savedDish = await dish.save();
        savedDishes.push(savedDish);
        console.log(`  ‚úÖ ${dishData.name.fr} cr√©√©`);
      }
    }

    // 4. Cr√©er quelques donn√©es analytics de simulation
    console.log('üìä Cr√©ation des donn√©es analytics...');
    const languages = ['fr', 'en', 'th', 'ru', 'de'];
    const actions = ['view', 'detail_view', 'search', 'favorite'];
    
    // G√©n√©rer 100 entr√©es analytics pour les 7 derniers jours
    for (let i = 0; i < 100; i++) {
      const randomDish = savedDishes[Math.floor(Math.random() * savedDishes.length)];
      const randomLanguage = languages[Math.floor(Math.random() * languages.length)];
      const randomAction = actions[Math.floor(Math.random() * actions.length)];
      
      // Date al√©atoire dans les 7 derniers jours
      const randomDate = new Date();
      randomDate.setDate(randomDate.getDate() - Math.floor(Math.random() * 7));
      
      const analytics = new MenuAnalytics({
        dishId: randomDish._id,
        action: randomAction,
        language: randomLanguage,
        sessionId: `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
        timestamp: randomDate,
        dayOfWeek: randomDate.getDay(),
        hourOfDay: randomDate.getHours(),
        deviceType: Math.random() > 0.8 ? 'tablet' : 'mobile',
        viewDuration: randomAction.includes('view') ? Math.floor(Math.random() * 300) + 10 : undefined
      });
      
      await analytics.save();
    }
    console.log('‚úÖ 100 entr√©es analytics cr√©√©es');

    console.log('\nüéâ SEEDING TERMIN√â AVEC SUCC√àS !');
    console.log('\nüìã R√âSUM√â :');
    console.log(`   üë§ 1 utilisateur admin`);
    console.log(`   üìÇ ${savedCategories.length} cat√©gories`);
    console.log(`   üçΩÔ∏è ${savedDishes.length} plats`);
    console.log(`   üìä 100 entr√©es analytics`);
    
    console.log('\nüîê CONNEXION ADMIN :');
    console.log('   Email: admin@restaurant-patong.com');
    console.log('   Mot de passe: admin123');
    
    console.log('\nüåê TESTEZ LE SYST√àME :');
    console.log('   Menu client: http://localhost:3000');
    console.log('   Admin: http://localhost:3002');
    console.log('   Analytics: http://localhost:3002/analytics');

  } catch (error) {
    console.error('‚ùå Erreur lors du seeding:', error);
  } finally {
    // Fermer la connexion
    await mongoose.connection.close();
    console.log('üîå Connexion MongoDB ferm√©e');
    process.exit(0);
  }
}

// Ex√©cuter le seeding si le script est appel√© directement
if (require.main === module) {
  seedDatabase();
}

export { seedDatabase };